'use strict';
<<<<<<< HEAD
const alias = ['stdin', 'stdout', 'stderr'];
=======
const aliases = ['stdin', 'stdout', 'stderr'];
>>>>>>> 29c383c5a9caa719b52a9a98c4553c70089fd49a

const hasAlias = opts => alias.some(x => Boolean(opts[x]));

<<<<<<< HEAD
module.exports = opts => {
	if (!opts) {
		return null;
=======
const normalizeStdio = options => {
	if (!options) {
		return;
>>>>>>> 29c383c5a9caa719b52a9a98c4553c70089fd49a
	}

	if (opts.stdio && hasAlias(opts)) {
		throw new Error(`It's not possible to provide \`stdio\` in combination with one of ${alias.map(x => `\`${x}\``).join(', ')}`);
	}

	if (typeof opts.stdio === 'string') {
		return opts.stdio;
	}

	const stdio = opts.stdio || [];

	if (!Array.isArray(stdio)) {
		throw new TypeError(`Expected \`stdio\` to be of type \`string\` or \`Array\`, got \`${typeof stdio}\``);
	}

<<<<<<< HEAD
	const result = [];
	const len = Math.max(stdio.length, alias.length);

	for (let i = 0; i < len; i++) {
		let value = null;

		if (stdio[i] !== undefined) {
			value = stdio[i];
		} else if (opts[alias[i]] !== undefined) {
			value = opts[alias[i]];
		}

		result[i] = value;
	}

	return result;
=======
	const length = Math.max(stdio.length, aliases.length);
	return Array.from({length}, (value, index) => stdio[index]);
};

module.exports = normalizeStdio;

// `ipc` is pushed unless it is already present
module.exports.node = options => {
	const stdio = normalizeStdio(options);

	if (stdio === 'ipc') {
		return 'ipc';
	}

	if (stdio === undefined || typeof stdio === 'string') {
		return [stdio, stdio, stdio, 'ipc'];
	}

	if (stdio.includes('ipc')) {
		return stdio;
	}

	return [...stdio, 'ipc'];
>>>>>>> 29c383c5a9caa719b52a9a98c4553c70089fd49a
};
